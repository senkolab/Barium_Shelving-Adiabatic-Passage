clearvars;
addpath('..\Functions');

%% All frequencies and details about them
%Format of DesiredTrans: [1:Frequency 2:F 3:mF 4:F' 5:mF' 6:Three? 7:Five? 8:Seven? 9:Clebsch]
DesiredTrans = [...
   "4020.050647", "1", "-1", "1", "-1", "yes", "yes", "yes", "0.03536034"; ...
   "4037.321568", "1", "0", "1", "0", "no", "no", "yes", "0.07072068"; ...
   "4054.150786", "1", "+1", "1", "+1", "yes", "yes", "yes", "0.03536034"; ...
   "4064.645765", "2", "+2", "2", "+2", "no", "yes", "yes", "0.02672548"; ...
   "4068.913075", "2", "+1", "2", "+1", "no", "no", "yes", "0.01336274"; ...
   "4073.019937", "2", "0", "2", "0", "yes", "yes", "yes", "0.02672548"; ...
   "4076.887145", "2", "-1", "2", "-1", "no", "no", "yes", "0.01336274"; ...
   "4080.376742", "2", "-2", "2", "-2", "no", "yes", "no", "0.02672548"];
%Format of OtherFreqs: [1:Frequency 2:F 3:mF 4:F' 5:mF' 6:3Care? 7:5Care? 8:7Care? 9:Clebsch]
OtherFreqs = [...
    "4007.011692", "2", "+2", "1", "0", "no", "yes", "yes", "0.00745"; ...
    "4011.11359", "2", "-1", "1", "-1", "yes", "yes", "yes", "0.01581"; ...
    "4017.699447", "2", "+1", "1", "-1", "yes", "yes", "yes", "0.00527"; ...
    "4026.636504", "1", "+1", "1", "-1", "yes", "yes", "yes", "0.035360338"; ...
    "4047.56493", "1", "-1", "1", "+1", "yes", "yes", "yes", "0.035360338"; ...
    "4058.065298", "2", "0", "2", "+2", "yes", "yes", "yes", "0.010910894"; ...
    "4062.327219", "2", "-1", "2", "+1", "no", "no", "yes", "0.013362742"; ...
    "4066.428678", "2", "-2", "2", "0", "yes", "yes", "yes", "0.010910894"; ...
    "4079.600404", "2", "+2", "2", "0", "yes", "yes", "yes", "0.010910894"; ...
    "4083.473002", "2", "+1", "2", "-1", "no", "no", "yes", "0.013362742"; ...
    "4086.968001", "2", "0", "2", "-2", "yes", "yes", "yes", "0.010910894"];

%Format of MotionalFreqs: [1:Frequency 2:WhichCarrier 3:Order 4:RedOrBlue?]
DesiredMotionalFreqs = [...
   "4016.050647", "1", "2", "red"; ...
   "4018.050647", "1", "1", "red"; ...
   "4022.050647", "1", "1", "blue"; ...
   "4024.050647", "1", "2", "blue"; ...
   "4033.321568", "2", "2", "red"; ...
   "4035.321568", "2", "1", "red"; ...
   "4039.321568", "2", "1", "blue"; ...
   "4041.321568", "2", "2", "blue"; ...
   "4050.150786", "3", "2", "red"; ...
   "4052.150786", "3", "1", "red"; ...
   "4056.150786", "3", "1", "blue"; ...
   "4058.150786", "3", "2", "blue"; ...
   "4060.645765", "4", "2", "red"; ...
   "4062.645765", "4", "1", "red"; ...
   "4064.913075", "5", "2", "red"; ...
   "4066.645765", "4", "1", "blue"; ...
   "4066.913075", "5", "1", "red"; ...
   "4068.645765", "4", "2", "blue"; ...
   "4069.019937", "6", "2", "red"; ...
   "4070.913075", "5", "1", "blue"; ...
   "4071.019937", "6", "1", "red"; ...
   "4072.887145", "7", "2", "red"; ...
   "4072.913075", "5", "2", "blue"; ...
   "4074.887145", "7", "1", "red"; ...
   "4075.019937", "6", "1", "blue"; ...
   "4076.376742", "8", "2", "red"; ...
   "4077.019937", "6", "2", "blue"; ...
   "4078.376742", "8", "1", "red"; ...
   "4078.887145", "7", "1", "blue"; ...
   "4080.887145", "7", "2", "blue"; ...
   "4082.376742", "8", "1", "blue"; ...
   "4084.376742", "8", "2", "blue"];
%Add transition name
Desiredd = DesiredTrans(str2double(DesiredMotionalFreqs(:, 2)), :);
%New format of DesiredMotionalFreqs: [1:Frequency 2:F 3:mF 4:F' 5:mF' 6:3Care?
%7:5Care? 8:7Care? 9:Clebsch 10:SidebandOrder 11:BlueOrRed?]
DesiredMotionalFreqs = [DesiredMotionalFreqs(:, 1), Desiredd(:, 2:9), ...
    DesiredMotionalFreqs(:, 3:4)];

%Format of OtherMotionalFreqs: [1:Frequency 2:WhichCarrier 3:Order 4:RedOrBlue?]
OtherMotionalFreqs = [...
   "4003.011692", "1", "2", "red"; ...
   "4005.011692", "1", "1", "red"; ...
   "4007.11359", "2", "2", "red"; ...
   "4009.011692", "1", "1", "blue"; ...
   "4009.11359", "2", "1", "red"; ...
   "4011.011692", "1", "2", "blue"; ...
   "4013.11359", "2", "2", "blue"; ...
   "4015.11359", "3", "2", "red"; ...
   "4013.699447", "2", "2", "red"; ...
   "4015.699447", "3", "1", "red"; ...
   "4019.699447", "3", "1", "blue"; ...
   "4021.699447", "3", "2", "blue"; ...
   "4022.636504", "4", "2", "red"; ...
   "4024.636504", "4", "1", "red"; ...
   "4028.636504", "4", "1", "blue"; ...
   "4030.636504", "4", "2", "blue"; ...
   "4043.56493", "5", "2", "red"; ...
   "4045.56493", "5", "1", "red"; ...
   "4049.56493", "5", "1", "blue"; ...
   "4051.56493", "5", "2", "blue"; ...
   "4054.065298", "6", "2", "red"; ...
   "4056.065298", "6", "1", "red"; ...
   "4058.327219", "7", "2", "red"; ...
   "4060.065298", "6", "1", "blue"; ...
   "4060.327219", "7", "1", "red"; ...
   "4062.065298", "6", "2", "blue"; ...
   "4062.428678", "8", "2", "red"; ...
   "4064.327219", "7", "1", "blue"; ...
   "4064.428678", "8", "1", "red"; ...
   "4066.327219", "7", "2", "blue"; ...
   "4068.428678", "8", "1", "blue"; ...
   "4070.428678", "8", "2", "blue"; ...
   "4075.600404", "9", "2", "red"; ...
   "4077.600404", "9", "1", "red"; ...
   "4079.473002", "10", "2", "red"; ...
   "4081.473002", "10", "1", "red";...
   "4081.600404", "9", "1", "blue";...
   "4082.968001", "11", "2", "red";...
   "4083.600404", "9", "2", "blue";...
   "4084.968001", "11", "1", "red";...
   "4085.473002", "10", "1", "blue";...
   "4087.473002", "10", "2", "blue";...
   "4088.968001", "11", "1", "blue";...
   "4090.968001", "11", "2", "blue"];
%Add transition name
Desiredd2 = OtherFreqs(str2double(OtherMotionalFreqs(:, 2)), :);
%New format of OtherMotionalFreqs: [1:Frequency 2:F 3:mF 4:F' 5:mF' 6:3Care?
%7:5Care? 8:7Care? 9:Clebsch 10:SidebandOrder 11:BlueOrRed?]
OtherMotionalFreqs = [OtherMotionalFreqs(:, 1), Desiredd2(:, 2:9), ...
    OtherMotionalFreqs(:, 3:4)];

MaxClebschs = max(str2double([DesiredTrans(:, 9); DesiredMotionalFreqs(:, 9); OtherFreqs(:, 9)]));

%% Figures
QuditLevels = "Seven";

G = getGlobals;

figure(1);
ax = gca;
hold on;

j = 0;
%Plot all the desired transitions
for i=1:length(DesiredTrans(:,1))
    Type = "Encoded";
    Trans = DesiredTrans(i, :);
    Color = G.EncodedColors(mod(j, length(G.EncodedColors))+1, :)/255;
    EncColorsTag(j+1, :) = [Trans(1:5) Color];
    if QuditLevels == "Three"
        [Plot, Line, Text, Area, j] = PlotTransition(6, Trans, MaxClebschs, Color, Type, j);
    elseif QuditLevels == "Five"
        [Plot, Line, Text, Area, j] = PlotTransition(7, Trans, MaxClebschs, Color, Type, j);
    elseif QuditLevels == "Seven"
        [Plot, Line, Text, Area, j] = PlotTransition(8, Trans, MaxClebschs, Color, Type, j);
    end
end
k=0;
%Plot Other frequencies
for i=1:length(OtherFreqs(:,1))
    Type = "Other";
    Trans = OtherFreqs(i, :);
    Color = G.OtherColors(mod(k, length(G.OtherColors))+1, :)/255;
    OtherColorsTag(k+1, :) = [Trans(1:5) Color];
    if QuditLevels == "Three"
        [Plot, Line, Text, Area, k] = PlotTransition(6, Trans, MaxClebschs, Color, Type, k);
    elseif QuditLevels == "Five"
        [Plot, Line, Text, Area, k] = PlotTransition(7, Trans, MaxClebschs, Color, Type, k);
    elseif QuditLevels == "Seven"
        [Plot, Line, Text, Area, k] = PlotTransition(8, Trans, MaxClebschs, Color, Type, k);
    end
end
%Plot Motional frequencies of encoded transitions
for i=1:length(DesiredMotionalFreqs(:,1))
    Type = "MotionalEncoded";
    Trans = DesiredMotionalFreqs(i, :);
    EncNum = find(EncColorsTag(:, 2) == Trans(2) & EncColorsTag(:, 3) == Trans(3) & EncColorsTag(:, 4) == Trans(4) & EncColorsTag(:, 5) == Trans(5));
    Color = str2double(EncColorsTag(EncNum, 6:8));
    if QuditLevels == "Three"
        [Plot, Line, Text, Area] = PlotTransition(6, Trans, MaxClebschs, Color, Type);
    elseif QuditLevels == "Five"
        [Plot, Line, Text, Area] = PlotTransition(7, Trans, MaxClebschs, Color, Type);
    elseif QuditLevels == "Seven"
        [Plot, Line, Text, Area] = PlotTransition(8, Trans, MaxClebschs, Color, Type);
    end
end
%Plot Motional frequencies of encoded transitions
for i=1:length(OtherMotionalFreqs(:,1))
    Type = "MotionalOther";
    Trans = OtherMotionalFreqs(i, :);
    OtherNum = find(OtherColorsTag(:, 2) == Trans(2) & OtherColorsTag(:, 3) == Trans(3) & OtherColorsTag(:, 4) == Trans(4) & OtherColorsTag(:, 5) == Trans(5));
    if isempty(OtherNum)
        Colors(i,:) = G.IrrelevantColor;
    else
        Colors(i,:) = str2double(OtherColorsTag(OtherNum, 6:8));
    end
    Color = Colors(i, :);
    if QuditLevels == "Three"
        [Plot, Line, Text, Area] = PlotTransition(6, Trans, MaxClebschs, Color, Type);
    elseif QuditLevels == "Five"
        [Plot, Line, Text, Area] = PlotTransition(7, Trans, MaxClebschs, Color, Type);
    elseif QuditLevels == "Seven"
        [Plot, Line, Text, Area] = PlotTransition(8, Trans, MaxClebschs, Color, Type);
    end
end
ColorsOther = Colors;

ax.XLim = [4000 4100];
Legend = sprintf('Encoded: Blue/Purple\nOther: Red/Orange\nLaserSweep: Shaded Areas\nIrrelevant: Grey\nMotional Sidebands: White Arrow');
if QuditLevels == "Three"
    ax.YLim = [0 G.ThreeLevelGraphCut];
    title('3-Level', 'FontSize', 16);
elseif QuditLevels == "Five"
    ax.YLim = [0 G.FiveLevelGraphCut];
    title('5-Level', 'FontSize', 16);
elseif QuditLevels == "Seven"
    ax.YLim = [0 G.SevenLevelGraphCut];
    title('7-Level', 'FontSize', 16);
end
ylabel('Normalized Strength', 'FontSize', 16);
xlabel('Frequency', 'FontSize', 16);
text(4060, G.FiveLevelGraphCut - .1, Legend, 'FontSize', 16);
%Set background color white
set(gcf,'color','white');